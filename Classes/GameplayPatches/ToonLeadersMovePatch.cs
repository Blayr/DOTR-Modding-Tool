using GameplayPatches;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GameplayPatches
{
    public class ToonLeadersMovePatch : Patch
    {
        static int patchLocation = 0x21f99c;
        static int TaTutoSetDeck35Part2 = 0x1484c0;

        public override bool IsApplied()
        {
            return dataAccess.CheckIfPatchApplied(patchLocation, new byte[8] { 0xf0, 0xe0, 0x05, 0x08, 0x00, 0x00, 0x00, 0x00 });
        }

        public override void Apply()
        {
            dataAccess.ApplyPatch(patchLocation, new byte[8] { 0xf0, 0xe0, 0x05, 0x08, 0x00, 0x00, 0x00, 0x00 });

            // Overwrites nopped bytes.
            dataAccess.ApplyPatch(TaTutoSetDeck35Part2, new byte[76] { 0x08, 0xc0, 0x80, 0x70, 0x08, 0x20, 0xc0, 0x72, 0x08, 0x78, 0x40, 0x70, 0x50, 0x7d, 0x07, 0x0c, 0x00, 0x00, 0x00, 0x00, 0xbc, 0x24, 0x09, 0x0c, 0x3c, 0x00, 0x44, 0x84, 0x07, 0x00, 0x02, 0x10, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x06, 0x24, 0x05, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x30, 0xe0, 0x71, 0x08, 0x20, 0xa0, 0x72, 0x29, 0x3e, 0x09, 0x08, 0x00, 0x00, 0x00, 0x00 });
        }

        public override void Remove()
        {
            // Restoring Nopped bytes is done elsewhere
            dataAccess.ApplyPatch(patchLocation, new byte[8] { 0x28, 0x36, 0x40, 0x70, 0x28, 0x26, 0xa0, 0x72 });
        }
    }
}
